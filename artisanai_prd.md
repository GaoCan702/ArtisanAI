*   **中文名称：** **智写匠 (Zhìxiě Jiàng)**
*   **英文名称：** **Artisan AI**

这个名字寓意“智能写作的工匠”，强调工具的专业、精准与高效。

---

### 产品需求文档 (PRD): 智写匠 (Artisan AI)

- **文档版本:** 1.2
- **更新日期:** 2025-08-12
- **状态:** 进行中（已同步当前实现）
- **创建人:** Gemini（由实现团队持续更新）

---

### 1. 背景与目标

#### 1.1 问题陈述
企业市场部、内容创作者以及个人创业者在进行产品推广时，需要撰写大量不同角度的营销文章。这个过程耗时、重复性高、角度容易枯竭，且人力成本高。

#### 1.2 产品愿景
打造一款极致简洁、高效的智能内容生成工具，基于已有公司与产品资料，批量生成高质量、多样化的营销文章初稿，显著提升内容生产效率。

#### 1.3 本期目标 (MVP)
提供一个跨平台桌面应用（Tauri 2 + Next.js 15），实现三栏工作流：左栏任务、中王文章列表、右栏文章详情；完成“输入资料 → 批量生成 → 复制/导出”的闭环。

---

### 2. 目标用户与场景

#### 2.1 目标用户画像
- 核心用户：中小企业市场营销专员、内容运营人员
- 次要用户：个人站长、自媒体博主、文案策划

#### 2.2 用户核心场景
用户粘贴公司与产品信息，设置生成数量与目标字数，启动任务。系统后台批量调用 LLM，持续反馈进度并流式更新内容，任务完成后可逐篇复制或整体导出。

---

### 3. 功能需求 (Functional Requirements)

当前实现基于“任务驱动”而非“公司/产品实体管理”。相较最初 PRD，取消了公司/产品的列表与持久化管理，改为在创建任务时一次性输入信息（更贴近 MVP）。

#### FR-0: 三栏工作流（UI 总览）
- 左栏：任务列表、创建任务、任务进度与状态指示，可折叠
- 中栏：所选任务的文章列表，实时高亮当前生成中的篇目，可折叠
- 右栏：文章详情（Markdown 渲染）、复制单篇/复制全部

#### FR-1: 任务创建与输入（输入端）
- 必须：通过“新建”弹窗填写以下字段：
  - 公司信息（长文本）
  - 产品/服务信息（长文本）
  - 生成数量（UI 约束 1-20，默认 5；引擎硬约束 1-100）
  - 目标字数（建议 200-2000，默认 800，容差 ±20%）
- 必须：校验输入合法性，统一由前端约束边界与解析
- 可选：未来支持从模板/知识库快速填充

#### FR-2: 批量生成引擎（处理核心）
- 模型：Google Gemini 1.5 Flash
- Prompt 模板：由后端提供（`get_prompt_template`），包含占位符 `{company_info}`、`{product_info}`
- 生成过程：串行逐篇生成；每篇完成后更新进度；相邻请求间隔 1s 防限流
- 输出格式：标准化 Markdown（#、##、段落空行、列表），不输出多余元信息
- 目标字数：若提供，将在 Prompt 中注明目标字数与容差（±20%）
- 容错：若单篇生成失败，回填“生成失败”的占位文章，任务继续

#### FR-3: 进度与状态反馈
- 任务状态：`pending` | `processing` | `completed` | `failed`
- 进度策略：按篇计数换算百分比，并高亮当前生成中的文章
- 流式回显：支持内容流式更新（在生成过程中实时回显部分 Markdown）
- 自动跟随：在处理中自动滚动至当前生成中的文章（可关闭）

#### FR-4: 结果查看与导出（输出端）
- 结果展示：列表浏览与详情预览（Markdown 渲染）
- 复制：支持复制单篇与复制全部
- 导出为文件：后端已实现 `export_content`（`markdown`/`txt`/`html`），前端将接入“全部导出”入口（下一步）

#### FR-5: 设置与密钥管理
- Gemini API Key 可通过“设置”弹窗保存至浏览器本地存储（优先级：传入 > localStorage > 环境变量）
- 提供“测试连接”能力，验证 Key 可用性
- 安全：Key 不上传服务器，仅用于本地 LLM 请求

#### FR-6: 桌面端打包
- Tauri 2 打包，支持 macOS、Windows（已产出 Windows 安装包）
- 前端采用 Next.js 15 静态导出，产物目录 `dist` 供 Tauri 使用

---

### 4. 非功能性需求 (NFR)
- 可用性：极简、直观的三栏布局，支持折叠与键鼠便捷操作
- 性能：UI 主线程不阻塞；逐篇节流请求；Markdown 渲染流畅
- 平台：桌面优先（macOS/Windows）；未来可探索 Linux
- 安全：仅本地存储 API Key；公司/产品资料不出本机；HTTPS 调用 LLM

---

### 5. 系统架构与数据流
- 前端：Next.js 15（React 19、Tailwind 4），以静态导出形式嵌入 Tauri
- 桌面端：Tauri 2（Rust），提供 `create_generation_task`、`update_task_progress`、`update_task_articles`、`get_prompt_template`、`export_content` 等指令
- 生成服务：`GeminiService` 负责与 Google Generative AI 通信，支持流式与同步两种模式
- 任务协调：`TaskService` 维护内存态任务清单，串行生成，多处通知 UI 刷新

时序（简化）：
1) 用户创建任务 → 2) 调用 Tauri 创建任务、取模板 → 3) 前端串行请求 LLM（逐篇流式）→ 4) 更新进度/文章到 Tauri → 5) 任务完成 → 6) 复制/导出

---

### 6. 约束与边界
- 文章数量：引擎约束 1-100；UI 默认 1-20
- 节流：两次调用间隔 1 秒（可调）
- 目标字数：按 ±20% 容差控制；为软约束
- 并发：当前串行（更稳定，易控速）
- 持久化：当前任务清单主要驻留内存；后续将接入本地数据库
- 导出格式：支持 markdown/txt/html；图片与富文本暂不支持
- 断点续传：暂不支持；失败篇目以占位内容记录

---

### 7. 成功指标 (Success Metrics)
- 任务成功率 > 95%
- 用户首周留存率
- 单次平均生成文章数量
- 定性反馈：内容质量与易用性评分

---

### 8. 后续规划（Roadmap）
- 本地数据持久化（任务、公司与产品库）与搜索
- “全部导出为文件”前端入口与批量导出为多文件夹
- 自定义 Prompt 模板与角度库管理
- 更丰富的模型与供应商支持，以及速率限制/重试/并发池
- 团队协作、多语言与可访问性优化

---

### 9. 变更记录
- 1.2（2025-08-12）：切换为任务驱动与三栏工作流；加入流式回显与目标字数；接入 Tauri 导出能力
- 1.1（2025-08-12）：初稿